(()=>{"use strict";({450:function(){var t=this&&this.__awaiter||function(t,o,e,n){return new(e||(e=Promise))((function(r,l){function i(t){try{c(n.next(t))}catch(t){l(t)}}function a(t){try{c(n.throw(t))}catch(t){l(t)}}function c(t){var o;t.done?r(t.value):(o=t.value,o instanceof e?o:new e((function(t){t(o)}))).then(i,a)}c((n=n.apply(t,o||[])).next())}))};chrome.runtime.onMessage.addListener(((o,e,n)=>{if("extract_data"===o.action)return t(void 0,void 0,void 0,(function*(){try{console.log("Starting scrolling to load all tracks..."),yield function(){return t(this,arguments,void 0,(function*(t=3e4){return new Promise(((o,e)=>{const n=Date.now();let r=0;const l=setInterval((()=>{window.scrollBy(0,window.innerHeight);const i=document.querySelectorAll('[data-testid="tracklist-row"]').length;console.log(`Tracks visible: ${i}`),i===r||Date.now()-n>t?(clearInterval(l),Date.now()-n>t?(console.warn("Scroll timeout exceeded"),e(new Error("Timeout while scrolling to load all tracks"))):(console.log("All tracks are loaded"),o())):r=i}),500)}))}))}(),console.log("Scrolling completed. Extracting data...");const o=document.querySelectorAll('[data-testid="tracklist-row"]'),e=Array.from(o).map((t=>{var o,e,n,r,l,i,a;const c=(null===(e=null===(o=t.querySelector(".encore-text-body-medium"))||void 0===o?void 0:o.textContent)||void 0===e?void 0:e.trim())||"Unknown",s=t.querySelectorAll(".encore-text-body-small a"),d=Array.from(s).map((t=>{var o;return(null===(o=t.textContent)||void 0===o?void 0:o.trim())||"Unknown"})).join(", ");return{title:c,artists:d,album:(null===(r=null===(n=t.querySelector(".standalone-ellipsis-one-line"))||void 0===n?void 0:n.textContent)||void 0===r?void 0:r.trim())||"Unknown",image:(null===(l=t.querySelector("img"))||void 0===l?void 0:l.getAttribute("src"))||"No image",duration:(null===(a=null===(i=t.querySelector(".l5CmSxiQaap8rWOOpEpk"))||void 0===i?void 0:i.textContent)||void 0===a?void 0:a.trim())||"Unknown"}}));console.log(`Extracted ${e.length} tracks`),n({data:e})}catch(t){console.error("Error during scrolling or extraction:",t instanceof Error?t.message:t),n({error:t instanceof Error?t.message:"Unknown error occurred"})}})),!0}))}})[450]()})();